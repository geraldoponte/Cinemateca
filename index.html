<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <link rel="stylesheet" href="/assets/css/style.css" />
        <link rel="stylesheet" href="/assets/css/footer.css" />

        <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp"
        crossorigin="anonymous"
        />

        <script 
          type="text/javascript"
          src="https://npmcdn.com/parse/dist/parse.min.js"
        ></script>       

        <title>Cinemateca N697</title>  
    </head>

    <body>
      
      <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N"
        crossorigin="anonymous"
      ></script> 
  
      <header>
          <h1><center>Cinemateca N697</center></h1>
      </header>

      <article>
      <div class="m-4">
          <ul class="nav nav-pills" id="menuCadastro">
            <li class="nav-item">
              <a href="#filmes" class="nav-link active" data-bs-toggle="tab">Filmes</a>
            </li>
            <li class="nav-item">
              <a href="#generos" class="nav-link" data-bs-toggle="tab">Gêneros</a>
            </li>
            <li class="nav-item">
              <a href="#atores" class="nav-link" data-bs-toggle="tab">Atores</a>
            </li>
            <li class="nav-item">
                <a href="#origens" class="nav-link" data-bs-toggle="tab">Países</a>
              </li>
          </ul>
          <div class="tab-content">
            <div class="tab-pane fade show active" id="filmes">
              <h4 class="mt-2">Cadastro de Filmes</h4>
              <div class="formularios">
                <form autocomplete="off">
                  <label for="tituloBr">Título do Filme (no Brasil)*</label>
                  <input id="tituloBr" type="text" class="input-padrao" required/>

                  <label for="tituloOriginal">Título Original</label>
                  <input id="tituloOriginal" type="text" class="input-padrao"/>

                  <label for="ano">Ano</label>
                  <input
                    id="ano"  
                    type="number"
                    min="1895"
                    max="2099"
                    step="1"
                    value=""                                           
                  /> 
                                    
                  <button id="btnSalvarFilme" class="enviar">Salvar Filme</button>
                </form>
              </div>
              <br />
              <div class="filmes-table">
                <table class="list" id="filmesList">
                  <thead>
                    <tr>
                      <th>Título BR</th>
                      <th>Título Original</th>
                      <th>Ano</th>                      
                      <th>Ações</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>

            <div class="tab-pane fade" id="generos">
              <h4 class="mt-2">Cadastro de Gêneros de Filmes</h4>  
              <div class="formularios">
                <form >
                  <input id="username" type="text" placeholder="Username" />
                  <input id="email" type="email" placeholder="Email" />
                  <input id="password" type="password" placeholder="Password" />
                  <button id="createButton">Create User</button>
                </form>           
              </div> 
            </div>

            <div class="tab-pane fade" id="atores">
              <h4 class="mt-2">Cadastro de Atores</h4>
              <p>
                Donec vel placerat quam, ut euismod risus. Sed a mi suscipit,
                elementum sem a, hendrerit velit. Donec at erat magna. Sed dignissim
                orci nec eleifend egestas. Donec eget mi consequat massa vestibulum
                laoreet. Mauris et ultrices nulla, malesuada volutpat ante. Fusce ut
                orci lorem. Donec molestie libero in tempus imperdiet. Cum sociis
                natoque penatibus et magnis.
              </p>
            </div>

            <div class="tab-pane fade" id="origens">
              <h4 class="mt-2">Cadastro de Países de Origem</h4>
              <p>
                Donec vel placerat quam, ut euismod risus. Sed a mi suscipit,
                elementum sem a, hendrerit velit. Donec at erat magna. Sed dignissim
                orci nec eleifend egestas. Donec eget mi consequat massa vestibulum
                laoreet. Mauris et ultrices nulla, malesuada volutpat ante. Fusce ut
                orci lorem. Donec molestie libero in tempus imperdiet. Cum sociis
                natoque penatibus et magnis.
              </p>
            </div>

          </div>
        </div>
      </article>   

      <footer>
        <div class="rodape">      
          <grid-container>
            <grid-item> Equipe: </style></grid-item>      
            <grid-item> - Bruno Andrade Aguiar Marques</grid-item>      
            <grid-item> - Geraldo Giovani Pinho da Ponte</grid-item>
            <grid-item> - Lucas Aguiar Marques</grid-item>        
            <grid-item> - Robson Silva Cardoso</grid-item>
          </grid-container>
          <p></p>
          <p><i>Background image by <a href="https://www.freepik.com/free-photo/movie-background-collage_33752471.htm#query=film%20background&position=8&from_view=keyword&track=ais">Freepik</a></i></p>
          <p><i>Powered by <a href="https://vercel.com/">Vercel</a> and <a href= "https://www.back4app.com/">Back4app</a></i></p>
        </div>
      </footer>
    </body>
    
    <script>
      // Initialize Parse
        Parse.initialize( 
          "SR88mOTb1V4tEj7QZn9yzLDJwjOYyUKtu0hKrHnq",
          "JPSSpkDvxjEGK0BwVtxgZ52Zg8wjqAgPQ1724Le6");
        Parse.serverURL = "https://parseapi.back4app.com/";    
        
        /*
        var Filme = Parse.Object.extend("Filme");

        getFilmes();

        function getFilmes() {
          queryFilmes = new Parse.Query(Filme);
          //alert(queryFilmes);
        }
        */

        // Cadastrar um novo FILME
        async function cadastrarFilme() {                              ;
          let filme = new Parse.Filme();                        
          filme.set("nomeBr", document.getElementById("tituloBr").value);            
          alert(filme.get("nomeBr"));
          filme.set("nomeOriginal", document.getElementById("tituloOriginal").value);
          filme.set("ano", document.getElementById("ano").value);
                    
          try {
            //alert("before save");
            filme = await filme.save();              
            //alert("after save");
            if (filme !== null) {              
              alert(
                `Filme cadastrado com sucesso! ObjectId: ${
                  filme.id                    
                }, ${filme.get("nomeBr")}`                  
              );
            }
          } catch (error) {
            alert(`Erro: ${error.message}`);
          }
          //alert("fim da função Cadastrar Filme");
        }

        document.getElementById("btnSalvarFilme").addEventListener("click", async function () {
          cadastrarFilme();
        });

        // Create a new User
        async function createParseUser() {
            // Creates a new Parse "User" object, which is created by default in your Parse app
            let user = new Parse.User();
            // Set the input values to the new "User" object
            user.set("username", document.getElementById("username").value);
            user.set("email", document.getElementById("email").value);
            user.set("password", document.getElementById("password").value);
            try { 
              // Call the save method, which returns the saved object if successful
              user = await user.save();
              
              if (user !== null) {
                // Notify the success by getting the attributes from the "User" object, by using the get method (the id attribute needs to be accessed directly, though)
                alert(
                  `New object created with success! ObjectId: ${
                    user.id
                  }, ${user.get("username")}`
                );
                
              }
            } catch (error) {
              alert(`Error: ${error.message}`);
            }
        };

        document.getElementById("createButton").addEventListener("click", async function () {
          createParseUser();
        });

    </script>   

</html>
